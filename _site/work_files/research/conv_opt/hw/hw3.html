<!DOCTYPE html>
<html lang="en-us">
  <head>
  <meta charset="UTF-8">
  <title>Ahmad Badary</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="theme-color" content="#157878">
  <link rel="stylesheet" href="/css/normalize.css">
  <link href='https://fonts.googleapis.com/css?family=Open+Sans:400,700' rel='stylesheet' type='text/css'>
  <link rel="stylesheet" href="/css/cayman.css">
  <link rel="stylesheet" href="/css/style.css">
  <link rel="shortcut icon" href="/main_files/favicon.ico" />
  <link rel="stylesheet" href="//maxcdn.bootstrapcdn.com/font-awesome/4.3.0/css/font-awesome.min.css">
  <link rel="stylesheet" href="/css/customStyle.css">
  <title> » Ahmad Badary</title>
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>
  <script type="text/javascript" async
  src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-MML-AM_CHTML">
  </script>
</head>

  <body>
    <nav class="main-nav">
    <a href="https://ahmedbadary.github.io/" class="main-nav-logo">
        <img src="/main_files/logo.png">
    </a>
    <ul id="menu-main" class="main-nav-items">
        <li id="menu-item-1859" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-home menu-item-1859">
            <a href="/">Home</a>
        </li>
        <li id="menu-item-2869" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-2869">
            <a href="/work">Work</a>
        </li>
        <li id="menu-item-1892" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-1892">
            <a href="/projects">Projects</a>
        </li>
        <li id="menu-item-1858" class="menu-item menu-item-type-post_type menu-item-object-page current_page_parent menu-item-1858">
            <a href="/blog">Blog</a>
        </li>
        <li id="menu-item-1862" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-1862">
            <a href="/about">About</a>
        </li>
    </ul>
</nav>


<section class="page-header">
  <h1 class="project-name">HW 3</h1>
  <h2 class="project-tagline"></h2>
  <a href="/#" class="btn">Home</a>
  <a href="/work" class="btn">Work-Space</a>
  <a href= /work_files/research/conv_opt.html class="btn">Previous</a>
</section>

<!-- <div>
  <ul class="posts">
    
      <li><span>02 Jan 2014</span> &raquo; <a href="/2014/01/02/introducing-Ahmad/">Introducing Ahmad</a></li>
    
  </ul>
</div> -->


    <section class="main-content">
      
      <h2 id="q1">Q.1)</h2>
<ol>
  <li>We quote the well-known Least-Squares expression that minimizes \(\|Ax-y\|_2^2\) over \(x\):
    <p>$$x^{(k)} = (A_k^TA_k)^{-1}A_k^Ty^{(k)}$$</p>
    <p>Where \((A_k^TA_k)^{-1}A_k^T\) is the projection operator.</p>
  </li>
  <li>First, we define
    <p>$$H_k = A_k^TA_k$$</p>
    <p>Then, notice</p>
    <p>$$
\begin{align}
\left(A_{k+1}^TA_{k+1}\right) &amp;= \left(A_k^TA_k + a_{k+1}a_{k+1}^T\right) = \left(H_k + a_{k+1}a_{k+1}^T\right) &amp; (1) \\
\left(A_{k+1}^T y^{k+1}\right) &amp;= \left(A_{k}^Ty^k + a_{k+1}y^{k+1}\right) &amp; (2) \\
\left(H_k + a_{k+1}a_{k+1}^T\right)^{-1} &amp;= H_k^{-1} - \dfrac{1}{1+a_{k+1}^TH_k^{-1}a_{k+1}} H_k^{-1}a_{k+1}a_{k+1}^TH_k^{-1} &amp; (3) \\
\end{align}$$</p>
    <blockquote>
      <p>We will use these three equations as we derive the solution.</p>
    </blockquote>
    <p> So, the objective function we are minimizing is:</p>
    <p>$$\|A_{k+1}x-y^{k+1}\|_2^2$$</p>
    <p>We notice, from the Least Squares solution in part 1 (and derived in Lecture) that the answer should have this form:</p>
    <p> $$x^{(k+1)} = (A_{k+1}^TA_{k+1})^{-1}A_{k+1}^Ty^{(k+1)}$$</p>
    <p>Now, we use the equations \(((1), (2), (3))\) we wrote out to find a solution given the parameters stated in the question,</p>
    <p> 
$$
\begin{align}
x^{(k+1)} &amp;= (A_{k+1}^TA_{k+1})^{-1}A_{k+1}^Ty^{(k+1)} \\
&amp;= \left(A_k^TA_k + a_{k+1}a_{k+1}^T\right)^{-1}A_{k+1}^Ty^{(k+1)} &amp; \text{from part } (1) \\
&amp;= \left(H_k + a_{k+1}a_{k+1}^T\right)^{-1}A_{k+1}^Ty^{(k+1)} &amp; \text{from part } (1) \\
&amp;= \left(H_k + a_{k+1}a_{k+1}^T\right)^{-1}\left(A_{k}^Ty^k + a_{k+1}y^{k+1}\right) &amp; \text{from part } (2) \\
&amp;= \left(H_k^{-1} - \dfrac{1}{1+a_{k+1}^TH_k^{-1}a_{k+1}} H_k^{-1}a_{k+1}a_{k+1}^TH_k^{-1}\right) \left(A_{k}^Ty^k + a_{k+1}y^{k+1}\right) &amp; \text{from part } (3)
\end{align}
$$
</p>
    <blockquote>
      <p>Notice that the inverse of \(A_k^TA_k\) always exists because \(A\) had Full-Column-Rank.</p>
    </blockquote>
    <p> Now, lets see whatx advantages does RLS possess.</p>
    <p>We notice that the inverse can be iteratively updated without recalculating the new inverse each time which implies that we do not have to re-compute the very expensive and very unstable “inverse”.<br />
This, obviously, requires some sort of hashing the old inverted matrix.</p>
    <blockquote>
      <p>Another way to rephrase this based on different application assuming you start mid-way,<br />
is saying that we only need to compute the inverse of a matrix that has a lower rank.</p>
    </blockquote>
  </li>
</ol>

<h2 id="q2">Q.2)</h2>
<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="n">np</span><span class="p">,</span> <span class="n">matplotlib</span><span class="p">.</span><span class="n">pyplot</span> <span class="k">as</span> <span class="n">plt</span><span class="p">,</span> <span class="n">matplotlib</span><span class="p">.</span><span class="n">patches</span> <span class="k">as</span> <span class="n">mpatches</span>
<span class="kn">from</span> <span class="nn">numpy</span> <span class="kn">import</span> <span class="o">*</span>
<span class="kn">from</span> <span class="nn">numpy.linalg</span> <span class="kn">import</span> <span class="o">*</span>
<span class="kn">from</span> <span class="nn">scipy.interpolate</span> <span class="kn">import</span> <span class="n">spline</span> <span class="c1">#ar = array ; %matplotlib inline # Please Uncomment + put each line on a separate line.
</span>
<span class="c1"># Variables
</span><span class="n">x</span> <span class="o">=</span> <span class="n">ar</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">6</span><span class="p">,</span><span class="mi">7</span><span class="p">,</span><span class="mi">8</span><span class="p">,</span><span class="mi">9</span><span class="p">])</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">ar</span><span class="p">([</span><span class="mf">5.31</span><span class="p">,</span> <span class="mf">5.61</span><span class="p">,</span> <span class="mf">5.28</span><span class="p">,</span> <span class="mf">5.54</span><span class="p">,</span> <span class="mf">3.85</span><span class="p">,</span> <span class="mf">4.49</span><span class="p">,</span> <span class="mf">5.99</span><span class="p">,</span> <span class="mf">5.32</span><span class="p">,</span> <span class="mf">4.39</span><span class="p">,</span> <span class="mf">4.73</span><span class="p">])</span>
<span class="n">mse_errs</span><span class="p">,</span> <span class="n">max_errs</span><span class="p">,</span> <span class="n">polys</span><span class="p">,</span> <span class="n">degs</span> <span class="o">=</span> <span class="p">[],</span> <span class="p">[],</span> <span class="p">[],</span> <span class="p">[</span><span class="n">i</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">9</span><span class="p">)]</span>
<span class="n">mse_errs_ext</span><span class="p">,</span> <span class="n">max_errs_ext</span><span class="p">,</span> <span class="n">polys_ext</span><span class="p">,</span> <span class="n">degs_ext</span> <span class="o">=</span> <span class="p">[],</span> <span class="p">[],</span> <span class="p">[],</span> <span class="p">[</span><span class="n">i</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">12</span><span class="p">)]</span>

<span class="c1"># Helper Functions
</span><span class="k">def</span> <span class="nf">mse</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">):</span>
    <span class="n">sm</span> <span class="o">=</span> <span class="p">[</span><span class="nb">abs</span><span class="p">(</span><span class="n">p</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="n">i</span><span class="p">])</span><span class="o">-</span><span class="n">y</span><span class="p">[</span><span class="n">i</span><span class="p">])</span><span class="o">**</span><span class="mi">2</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">))]</span>
    <span class="k">return</span> <span class="nb">sum</span><span class="p">(</span><span class="n">sm</span><span class="p">)</span><span class="o">/</span><span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">),</span> <span class="n">sm</span><span class="p">[</span><span class="n">argmax</span><span class="p">(</span><span class="n">sm</span><span class="p">)]</span>

<span class="k">def</span> <span class="nf">plot_err</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">xlabel</span><span class="p">,</span> <span class="n">ylabel</span><span class="p">,</span> <span class="n">title</span><span class="p">,</span> <span class="n">xlim</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">ylim</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
    <span class="n">_</span> <span class="o">=</span> <span class="n">plt</span><span class="p">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="s">'.'</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="s">'r'</span><span class="p">)</span>
    <span class="n">plt</span><span class="p">.</span><span class="n">xlabel</span><span class="p">(</span><span class="n">xlabel</span><span class="p">,</span> <span class="n">fontweight</span><span class="o">=</span><span class="s">'bold'</span><span class="p">)</span>
    <span class="n">plt</span><span class="p">.</span><span class="n">ylabel</span><span class="p">(</span><span class="n">ylabel</span><span class="p">,</span> <span class="n">fontweight</span><span class="o">=</span><span class="s">'bold'</span><span class="p">)</span>
    <span class="n">plt</span><span class="p">.</span><span class="n">title</span><span class="p">(</span><span class="n">title</span><span class="p">,</span>  <span class="n">fontsize</span><span class="o">=</span><span class="mi">15</span><span class="p">,</span><span class="n">y</span><span class="o">=</span><span class="mf">1.04</span><span class="p">)</span>
    <span class="n">plt</span><span class="p">.</span><span class="n">gca</span><span class="p">().</span><span class="n">title</span><span class="p">.</span><span class="n">set_color</span><span class="p">(</span><span class="s">'red'</span><span class="p">)</span>
    <span class="n">plt</span><span class="p">.</span><span class="n">gca</span><span class="p">().</span><span class="n">yaxis</span><span class="p">.</span><span class="n">label</span><span class="p">.</span><span class="n">set_color</span><span class="p">(</span><span class="s">'red'</span><span class="p">)</span>
    <span class="n">plt</span><span class="p">.</span><span class="n">gca</span><span class="p">().</span><span class="n">xaxis</span><span class="p">.</span><span class="n">label</span><span class="p">.</span><span class="n">set_color</span><span class="p">(</span><span class="s">'red'</span><span class="p">)</span>
    <span class="n">plt</span><span class="p">.</span><span class="n">gca</span><span class="p">().</span><span class="n">spines</span><span class="p">[</span><span class="s">"top"</span><span class="p">].</span><span class="n">set_visible</span><span class="p">(</span><span class="bp">False</span><span class="p">)</span>
    <span class="n">plt</span><span class="p">.</span><span class="n">gca</span><span class="p">().</span><span class="n">spines</span><span class="p">[</span><span class="s">"right"</span><span class="p">].</span><span class="n">set_visible</span><span class="p">(</span><span class="bp">False</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">xlim</span> <span class="o">!=</span> <span class="bp">None</span><span class="p">:</span>
        <span class="n">plt</span><span class="p">.</span><span class="n">gca</span><span class="p">().</span><span class="n">set_xlim</span><span class="p">(</span><span class="n">xlim</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">ylim</span> <span class="o">!=</span> <span class="bp">None</span><span class="p">:</span>
        <span class="n">plt</span><span class="p">.</span><span class="n">gca</span><span class="p">().</span><span class="n">set_ylim</span><span class="p">(</span><span class="n">ylim</span><span class="p">)</span>
    <span class="n">plt</span><span class="p">.</span><span class="n">show</span><span class="p">()</span>

<span class="c1"># Answers to the sub-questions
</span><span class="k">def</span> <span class="nf">q2_1</span><span class="p">():</span>
    <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span><span class="mi">9</span><span class="p">):</span>
        <span class="n">p</span> <span class="o">=</span> <span class="n">poly1d</span><span class="p">(</span><span class="n">polyfit</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">n</span><span class="p">))</span>
        <span class="n">polys</span><span class="p">.</span><span class="n">append</span><span class="p">(</span><span class="n">p</span><span class="p">)</span>
        <span class="k">print</span><span class="p">(</span><span class="s">"n ="</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="s">":  p_"</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">n</span><span class="p">),</span><span class="s">" ="</span><span class="p">,</span><span class="n">p</span><span class="p">,</span> <span class="s">"</span><span class="se">\n</span><span class="s">"</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">q2_2</span><span class="p">():</span>   
    <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span><span class="mi">9</span><span class="p">):</span>
        <span class="n">p</span> <span class="o">=</span> <span class="n">poly1d</span><span class="p">(</span><span class="n">polyfit</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">n</span><span class="p">))</span>
        <span class="n">mse_errs</span><span class="p">.</span><span class="n">append</span><span class="p">(</span><span class="nb">round</span><span class="p">(</span><span class="n">mse</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)[</span><span class="mi">0</span><span class="p">],</span> <span class="mi">11</span><span class="p">))</span>
        <span class="n">max_errs</span><span class="p">.</span><span class="n">append</span><span class="p">(</span><span class="nb">round</span><span class="p">(</span><span class="n">mse</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)[</span><span class="mi">1</span><span class="p">],</span> <span class="mi">10</span><span class="p">))</span>
        <span class="k">print</span><span class="p">(</span><span class="s">"n ="</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="s">":  Mean_Sq_Err ="</span><span class="p">,</span> <span class="nb">round</span><span class="p">(</span><span class="n">mse</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)[</span><span class="mi">0</span><span class="p">],</span> <span class="mi">11</span><span class="p">),</span> <span class="s">"| Max_Err ="</span><span class="p">,</span> <span class="nb">round</span><span class="p">(</span><span class="n">mse</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)[</span><span class="mi">1</span><span class="p">],</span> <span class="mi">10</span><span class="p">))</span>

<span class="k">def</span> <span class="nf">plot_errs</span><span class="p">():</span>
    <span class="n">plot_err</span><span class="p">(</span><span class="n">degs</span><span class="p">,</span> <span class="n">mse_errs</span><span class="p">,</span> <span class="s">"degree"</span><span class="p">,</span> <span class="s">"MSE-Err"</span><span class="p">,</span> <span class="s">'MSE-Err vs Degree'</span><span class="p">,</span> <span class="n">xlim</span><span class="o">=</span><span class="p">[</span><span class="mf">2.9</span><span class="p">,</span><span class="mf">11.1</span><span class="p">],</span> <span class="n">ylim</span><span class="o">=</span><span class="p">[</span><span class="o">-</span><span class="mf">0.01</span><span class="p">,.</span><span class="mi">35</span><span class="p">])</span>
    <span class="n">plot_err</span><span class="p">(</span><span class="n">degs</span><span class="p">,</span> <span class="n">max_errs</span><span class="p">,</span> <span class="s">"degree"</span><span class="p">,</span> <span class="s">"MAX-Err"</span><span class="p">,</span> <span class="s">'MAX-Err vs Degree'</span><span class="p">,</span> <span class="n">xlim</span><span class="o">=</span><span class="p">[</span><span class="mf">4.9</span><span class="p">,</span><span class="mf">8.1</span><span class="p">])</span>

<span class="s">""" Void
This function creates more polynomials with different degrees in [3, 12) (hence, "extended").
Then it plots them.
"""</span>
<span class="k">def</span> <span class="nf">plot_extended_errs</span><span class="p">():</span>
    <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">12</span><span class="p">):</span>
        <span class="n">p</span> <span class="o">=</span> <span class="n">poly1d</span><span class="p">(</span><span class="n">polyfit</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">n</span><span class="p">))</span>
        <span class="n">polys_ext</span><span class="p">.</span><span class="n">append</span><span class="p">(</span><span class="n">p</span><span class="p">)</span>
        <span class="n">mse_errs_ext</span><span class="p">.</span><span class="n">append</span><span class="p">(</span><span class="n">mse</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)[</span><span class="mi">0</span><span class="p">])</span>
        <span class="n">max_errs_ext</span><span class="p">.</span><span class="n">append</span><span class="p">(</span><span class="n">mse</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)[</span><span class="mi">1</span><span class="p">])</span>
    <span class="n">plot_err</span><span class="p">(</span><span class="n">degs_ext</span><span class="p">,</span> <span class="n">mse_errs_ext</span><span class="p">,</span> <span class="s">"degree-extended"</span><span class="p">,</span> <span class="s">"MSE-Err"</span><span class="p">,</span> <span class="s">'MSE-Err vs Degree-Extended '</span><span class="p">,</span> <span class="n">xlim</span><span class="o">=</span><span class="p">[</span><span class="mf">2.9</span><span class="p">,</span><span class="mf">11.1</span><span class="p">],</span> <span class="n">ylim</span><span class="o">=</span><span class="p">[</span><span class="o">-</span><span class="mf">0.01</span><span class="p">,.</span><span class="mi">35</span><span class="p">])</span>
    <span class="n">plot_err</span><span class="p">(</span><span class="n">degs_ext</span><span class="p">,</span> <span class="n">max_errs_ext</span><span class="p">,</span> <span class="s">"degree-extended"</span><span class="p">,</span> <span class="s">"MAX-Err"</span><span class="p">,</span> <span class="s">'MAX-Err vs Degree-Extended '</span><span class="p">,</span> <span class="n">xlim</span><span class="o">=</span><span class="p">[</span><span class="mf">2.9</span><span class="p">,</span><span class="mf">11.1</span><span class="p">],</span> <span class="n">ylim</span><span class="o">=</span><span class="p">[</span><span class="o">-</span><span class="mf">0.01</span><span class="p">,</span><span class="mf">1.35</span><span class="p">])</span>
</code></pre></div></div>
<blockquote>
  <p>Notice, all the code blocks below (Q.2) refer to this piece of code above.</p>
</blockquote>

<ol>
  <li>We proceed by using the “polyfit” module in “numpy”.
    <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code> <span class="o">&gt;&gt;&gt;</span> <span class="n">q2_1</span><span class="p">()</span>
                              <span class="mi">5</span>           <span class="mi">4</span>          <span class="mi">3</span>         <span class="mi">2</span>         <span class="mi">1</span>
 <span class="o">&gt;&gt;&gt;</span> <span class="n">n</span> <span class="o">=</span> <span class="mi">5</span> <span class="p">:</span>  <span class="n">P_5</span> <span class="o">=</span> <span class="mf">0.002876</span> <span class="n">x</span> <span class="o">-</span> <span class="mf">0.06977</span> <span class="n">x</span> <span class="o">+</span> <span class="mf">0.5933</span> <span class="n">x</span> <span class="o">-</span> <span class="mf">2.043</span> <span class="n">x</span> <span class="o">+</span> <span class="mf">2.259</span> <span class="n">x</span> <span class="o">+</span> <span class="mf">5.2</span>
                              <span class="mi">6</span>           <span class="mi">5</span>          <span class="mi">4</span>         <span class="mi">3</span>         <span class="mi">2</span>         <span class="mi">1</span>  
 <span class="o">&gt;&gt;&gt;</span> <span class="n">n</span> <span class="o">=</span> <span class="mi">6</span> <span class="p">:</span>  <span class="n">P_6</span> <span class="o">=</span> <span class="mf">0.001985</span> <span class="n">x</span> <span class="o">-</span> <span class="mf">0.05071</span> <span class="n">x</span> <span class="o">+</span> <span class="mf">0.4724</span> <span class="n">x</span> <span class="o">-</span> <span class="mf">1.932</span> <span class="n">x</span> <span class="o">+</span> <span class="mf">3.237</span> <span class="n">x</span> <span class="o">-</span> <span class="mf">1.593</span> <span class="n">x</span> <span class="o">+</span> <span class="mf">5.33</span>
                               <span class="mi">7</span>            <span class="mi">6</span>           <span class="mi">5</span>          <span class="mi">4</span>         <span class="mi">3</span>         <span class="mi">2</span>
 <span class="o">&gt;&gt;&gt;</span> <span class="n">n</span> <span class="o">=</span> <span class="mi">7</span> <span class="p">:</span>  <span class="n">P_7</span> <span class="o">=</span> <span class="mf">4.785e-06</span> <span class="n">x</span> <span class="o">+</span> <span class="mf">0.001834</span> <span class="n">x</span> <span class="o">-</span> <span class="mf">0.04884</span> <span class="n">x</span> <span class="o">+</span> <span class="mf">0.4609</span> <span class="n">x</span> <span class="o">-</span> <span class="mf">1.895</span> <span class="n">x</span> <span class="o">+</span> <span class="mf">3.181</span> <span class="n">x</span> <span class="o">-</span> <span class="mf">1.562</span> <span class="n">x</span> <span class="o">+</span> <span class="mf">5.33</span>
                             <span class="mi">8</span>          <span class="mi">7</span>         <span class="mi">6</span>         <span class="mi">5</span>         <span class="mi">4</span>         <span class="mi">3</span>         <span class="mi">2</span>
 <span class="o">&gt;&gt;&gt;</span> <span class="n">n</span> <span class="o">=</span> <span class="mi">8</span> <span class="p">:</span>  <span class="n">P_8</span> <span class="o">=</span> <span class="o">-</span><span class="p">.</span><span class="mi">00067</span> <span class="n">x</span> <span class="o">+</span> <span class="p">.</span><span class="mi">02413</span> <span class="n">x</span> <span class="o">-</span> <span class="p">.</span><span class="mi">3528</span> <span class="n">x</span> <span class="o">+</span> <span class="mf">2.687</span> <span class="n">x</span> <span class="o">-</span> <span class="mf">11.37</span> <span class="n">x</span> <span class="o">+</span> <span class="mf">26.32</span> <span class="n">x</span>  <span class="o">-</span> <span class="mf">30.5</span> <span class="n">x</span> <span class="o">+</span> <span class="mf">13.46</span> <span class="n">x</span> <span class="o">+</span> <span class="mf">5.31</span>
</code></pre></div>    </div>
    <p>This gives us the solutions:</p>
    <p>$$
     P_5(x) = 0.002876 x^{5} - 0.06977 x^{4} + 0.5933 x^{3} - 2.043 x^{2} + 2.259 x^{1} + 5.2 \\
     P_6(x) = 0.001985 x^{6} - 0.05071 x^{5} + 0.4724 x^{4} - 1.932 x^{3} + 3.237 x^{2} - 1.593 x^{1} + 5.33 \\
     P_7(x) = 4.785 \cdot 10^6 x^{7} + 0.001834 x^{6} - 0.04884 x^{5} + 0.4609 x^{4} - 1.895 x^{3} + 3.181 x^{2} - 1.562 x^{1} + 5.33 \\
     P_8(x) = -6.701 \cdot 10^{-4} x^{8} + 0.02413 x^{7} - 0.3528 x^{6} + 2.687 x^{5} - 11.37 x^{4} + 26.32 x^{3} - 30.49 x^{2} + 13.46 x^{1} + 5.311
     $$
 </p>
    <p>Let’s plot the polynomials against each other.<br />
 When we do so, we will notice how much each polynomial oscillates and we will see which polynomial actually goes through the data points (in blue).<br />
 <img src="/main_files/conv_opt/3/3.1/espp.png" width="70%" style="position: relative;" /></p>
    <blockquote>
      <p>Please refer to the legend to differentiate the polynomials.</p>
    </blockquote>
  </li>
  <li>We proceed by using the found polynomials and the defined “mean-squared-loss” function.
    <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code> <span class="o">&gt;&gt;&gt;</span> <span class="n">q2_2</span><span class="p">()</span>
 <span class="o">&gt;&gt;&gt;</span> <span class="n">n</span> <span class="o">=</span> <span class="mi">5</span> <span class="p">:</span>  <span class="n">Mean_Sq_Err</span> <span class="o">=</span> <span class="mf">0.23202104429</span> <span class="o">|</span> <span class="n">Max_Err</span> <span class="o">=</span> <span class="mf">0.7823959188</span>
 <span class="o">&gt;&gt;&gt;</span> <span class="n">n</span> <span class="o">=</span> <span class="mi">6</span> <span class="p">:</span>  <span class="n">Mean_Sq_Err</span> <span class="o">=</span> <span class="mf">0.10826098368</span> <span class="o">|</span> <span class="n">Max_Err</span> <span class="o">=</span> <span class="mf">0.3902666906</span>
 <span class="o">&gt;&gt;&gt;</span> <span class="n">n</span> <span class="o">=</span> <span class="mi">7</span> <span class="p">:</span>  <span class="n">Mean_Sq_Err</span> <span class="o">=</span> <span class="mf">0.10825867873</span> <span class="o">|</span> <span class="n">Max_Err</span> <span class="o">=</span> <span class="mf">0.3887930312</span>
 <span class="o">&gt;&gt;&gt;</span> <span class="n">n</span> <span class="o">=</span> <span class="mi">8</span> <span class="p">:</span>  <span class="n">Mean_Sq_Err</span> <span class="o">=</span> <span class="mf">0.00614953188</span> <span class="o">|</span> <span class="n">Max_Err</span> <span class="o">=</span> <span class="mf">0.0200802073</span>
</code></pre></div>    </div>
    <p>Now, we plot them and compare them with each other.<br />
 <img src="/main_files/conv_opt/3/3.1/esp1.png" width="48%" style="position: relative;" />
 <img src="/main_files/conv_opt/3/3.1/esp2.png" width="48%" style="position: relative;" /><br />
 We notice that as the degree of the polynomial increases (upto \(n=8\)) the accuracy increases and the error decreases.<br />
 This can be contributed to the degree of oscillation of the data itself which can be readily seen in the plot of the data and it’s “Spline-Interpolation”:<br />
 <img src="/main_files/conv_opt/3/3.1/esp3.png" width="70%" style="position: relative;left:50px" /><br />
 As you can see, the data points are quite non-monotonic, in-fact, they oscillate wildly. Thus, it will be very hard to model this data with a line for example, or with any polynomial of insufficient degree of oscillation.<br />
 However, we should remember Runge’s phenomenon (i.e. the “wildly-oscillating polynomials” problem). This tells us that as the degree of the interpolating (or regression) polynomial increases, the approximation becomes very very unstable outside of the domain of regression.<br />
 In-fact, as we will see further below, the optimal degree (not necessarily in the domain) is actually \(n = 10\).</p>
  </li>
</ol>

<hr />

<ol>
  <li>[FurtherAnalysis]</li>
</ol>

<h2 id="q3">Q.3)</h2>
<ol>
  <li>We begin our analysis by manipulating the equations algebraically.
    <p>$$ \begin{align}
     \|x-a_1\|^2 &amp;= d_1^2 \\
     \|x-a_2\|^2 &amp;= d_2^2 \\
     \|x-a_3\|^2 &amp;= d_3^2 \\
     \end{align}\\
     $$
     $$
     \implies \\
     $$
     $$
     \begin{align}
     x^Tx−2a_1^Tx+\|a_1\|^2 &amp;= d_1^2 &amp;(1)\\ 
     x^Tx−2a_2^Tx+\|a_2\|^2 &amp;= d_2^2 &amp;(2)\\ 
     x^Tx−2a_3^Tx+\|a_3\|^2 &amp;= d_3^2 &amp;(3)
     \end{align}
     $$  </p>
    <p>We subtract Eq. \((1)\) from Eq. \((2)\) and again from Eq. \((3)\).</p>
    <p>$$\iff \\$$
 $$ \begin{align}
     2(a_1 − a_2)^Tx &amp;= \|a_1\|^2 − \|a_2\|^2 − d_1^2 + d_2^2 \\
     2(a_1 − a_3)^Tx &amp;= \|a_1\|^2 − \|a_3\|^2 − d_1^2 + d_3^2 
     \end{align}\\
     \implies
     $$
 $$
 \begin{align}
 \left[ \begin{array}{c}   2(a_1 − a_2)^T \\ 
                             2(a_1 − a_3)^T  
  \end{array} \right]\vec{x} &amp;= \left[ \begin{array}{c}   \|a_1\|^2 − \|a_2\|^2 − d_1^2 + d_2^2 \\ 
                             \|a_1\|^2 − \|a_3\|^2 − d_1^2 + d_3^2  
  \end{array} \right]
  \\ \\
  &amp;\iff \\
  A\vec{x} &amp;= \vec{y}
  \end{align}
 $$</p>
  </li>
  <li>What we are looking for is what/how the petrubations in the measurement correspond to in the column space.<br />
 We notice that really all we need is to look at what the inverse of \(A\) does to the unit ball (unit circle in  \(\mathbf{R}^2\)).<br />
 We proceed by computing \(A^{-1}\) and then finding the SVD of the inverse matrix. We, then, use the properties of the SVD and the singular values to compute the volumes (areas) of the ellipsoids resulting from transforming the unit ball.<br />
 The example (ellipsoid) with the smaller volume will have less petrubations in the column space (range) of the output \(x\).
    <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code> <span class="o">&gt;&gt;&gt;</span> <span class="n">q_3_2</span><span class="p">()</span>
 <span class="o">&gt;&gt;&gt;</span> <span class="n">ArgMin</span> <span class="o">=</span>  <span class="mi">2</span>  <span class="p">:</span> <span class="n">Min</span> <span class="o">=</span>  <span class="mf">0.0523598775598</span>
</code></pre></div>    </div>
    <p>We see that the ellipsoid induced by the second scenario is actually smaller and thus has a better chance of getting the correct solution \(x^\ast\) with the same bound on the petrubation in the measurement vector.<br />
 Now, the region of uncertainty is just the ellipsoid itself which is characterized by the SVD of \(A^{-1}\):<br />
 Region of uncertainty case 1: \(\frac{\left(x\right)^2}{0.64339784}+\frac{\left(y\right)^2}{0.07771242}=1^2\)<br />
 Region of uncertainty case 2: \(\frac{\left(x\right)^2}{0.16666667}+\frac{\left(y\right)^2}{0.1}=1^2\)<br />
 Both can be seen here:<br />
 <img src="/main_files/conv_opt/3/3.1/esp4.png" width="50%" height="30%" style="position: relative;" /></p>
    <blockquote>
      <p>case 1: Highlighted ; case 2: not-Highlighted</p>
    </blockquote>

    <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code> <span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="n">np</span>
 <span class="kn">from</span> <span class="nn">numpy</span> <span class="kn">import</span> <span class="o">*</span>
 <span class="kn">from</span> <span class="nn">numpy.linalg</span> <span class="kn">import</span> <span class="o">*</span>
 <span class="n">ar</span> <span class="o">=</span> <span class="n">array</span>

 <span class="c1"># Helper Function
</span> <span class="k">def</span> <span class="nf">ellipse_area</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">):</span>
     <span class="k">return</span> <span class="n">pi</span><span class="o">*</span><span class="n">a</span><span class="o">*</span><span class="n">b</span>

 <span class="k">def</span> <span class="nf">get_area</span><span class="p">(</span><span class="n">a1</span><span class="p">,</span> <span class="n">a2</span><span class="p">,</span> <span class="n">a3</span><span class="p">):</span>
     <span class="n">a1</span><span class="p">,</span> <span class="n">a2</span><span class="p">,</span> <span class="n">a3</span> <span class="o">=</span> <span class="n">a1</span><span class="p">,</span> <span class="n">a2</span><span class="p">,</span> <span class="n">a3</span>
     <span class="n">A</span> <span class="o">=</span> <span class="n">ar</span><span class="p">([</span><span class="mi">2</span><span class="o">*</span><span class="p">(</span><span class="n">a1</span><span class="o">-</span><span class="n">a2</span><span class="p">).</span><span class="n">T</span><span class="p">,</span> <span class="mi">2</span><span class="o">*</span><span class="p">(</span><span class="n">a1</span><span class="o">-</span><span class="n">a3</span><span class="p">).</span><span class="n">T</span><span class="p">])</span>
     <span class="n">U</span><span class="p">,</span> <span class="n">s</span><span class="p">,</span> <span class="n">V</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="n">linalg</span><span class="p">.</span><span class="n">svd</span><span class="p">(</span><span class="n">inv</span><span class="p">(</span><span class="n">A</span><span class="p">),</span> <span class="n">full_matrices</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
     <span class="k">return</span> <span class="n">ellipse_area</span><span class="p">(</span><span class="n">s</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">s</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>

 <span class="c1"># Solutions to sub-problems
</span> <span class="k">def</span> <span class="nf">q_3_2</span><span class="p">():</span>
     <span class="n">area1</span><span class="p">,</span> <span class="n">area2</span> <span class="o">=</span> <span class="n">get_area</span><span class="p">(</span><span class="n">ar</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">]),</span> <span class="n">ar</span><span class="p">([</span><span class="mi">4</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">]),</span> <span class="n">ar</span><span class="p">([</span><span class="mi">5</span><span class="p">,</span><span class="mi">0</span><span class="p">])),</span> <span class="n">get_area</span><span class="p">(</span><span class="n">ar</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">]),</span> <span class="n">ar</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">3</span><span class="p">]),</span> <span class="n">ar</span><span class="p">([</span><span class="mi">5</span><span class="p">,</span><span class="mi">0</span><span class="p">]))</span>
     <span class="k">print</span><span class="p">(</span><span class="s">"ArgMin = "</span><span class="p">,</span> <span class="n">argmin</span><span class="p">([</span><span class="n">area1</span><span class="p">,</span><span class="n">area2</span><span class="p">])</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span> <span class="s">" : Min = "</span><span class="p">,</span> <span class="nb">min</span><span class="p">(</span><span class="n">area1</span><span class="p">,</span> <span class="n">area2</span><span class="p">))</span>
</code></pre></div>    </div>
    <blockquote>
      <p>Please notice that this is the code that Q.3 is referring to.</p>
    </blockquote>
  </li>
</ol>

<p><img src="/main_files/conv_opt/3/3.1/esp5.png" /></p>


      <footer class="site-footer">
    <!--   <span class="site-footer-owner"><a href="http://localhost:8889">Ahmad Badary</a> is maintained by <a href="https://ahmedbadary.github.io/">Ahmad Badary</a>.</span> -->
    
<!--  -->
    <div class="wrapper">
        <div class="footer-col-wrapper">
            <div class="footer-col footer-col-1">
            <span class="site-footer-owner"><a href="http://localhost:8889">Site</a> maintained by <a href="https://ahmedbadary.github.io/">Ahmad Badary</a>.</span>
    <span class="site-footer-credits">
        <p>
            &copy; 2017. All rights reserved.
        </p> 
    </span>
            </div>
            <div class="footer-col footer-col-2">
            <div><p>         </p></div>
            </div>
            <div class="footer-col footer-col-3">
                <ul class="social-media-list">
                    
                      <li>
                        <a href="https://github.com/AhmedBadary">
                          <i class="fa fa-github"></i> GitHub
                        </a>
                      </li>
                    
                    
                      <li>
                        <a href="https://linkedin.com/in/ahmad-badary-656098121/">
                          <i class="fa fa-linkedin"></i> LinkedIn
                        </a>
                      </li>
                    
                    
                      <li>
                        <a href="https://www.facebook.com/ahmed.thabet.94">
                          <i class="fa fa-facebook"></i> Facebook
                        </a>
                      </li>
                    
                </ul>
            </div>
        </div>
    </div>
<!--  -->
</footer>


    </section>

  </body>

<!-- Table of Content Script -->
<script type="text/javascript">
var bodyContents = $(".bodyContents1");
$("<ol>").addClass("TOC1ul").appendTo(".TOC1");
bodyContents.each(function(index, element) {
    var paragraph = $(element);
    $("<li>").html("<a href=#"+paragraph.attr('id')+">"+ paragraph.html().replace(':','')+" </a> ").appendTo(".TOC1ul");
     });
// 
var bodyContents = $(".bodyContents2");
$("<ol>").addClass("TOC2ul").appendTo(".TOC2");
bodyContents.each(function(index, element) {
    var paragraph = $(element);
    $("<li>").html("<a href=#"+paragraph.attr('id')+">"+ paragraph.html().replace(':','')+" </a> ").appendTo(".TOC2ul");
     });
// 
var bodyContents = $(".bodyContents3");
$("<ol>").addClass("TOC3ul").appendTo(".TOC3");
bodyContents.each(function(index, element) {
    var paragraph = $(element);
    $("<li>").html("<a href=#"+paragraph.attr('id')+">"+ paragraph.html().replace(':','')+" </a> ").appendTo(".TOC3ul");
     });
//
var bodyContents = $(".bodyContents4");
$("<ol>").addClass("TOC4ul").appendTo(".TOC4");
bodyContents.each(function(index, element) {
    var paragraph = $(element);
    $("<li>").html("<a href=#"+paragraph.attr('id')+">"+ paragraph.html().replace(':','')+" </a> ").appendTo(".TOC4ul");
     });
//
var bodyContents = $(".bodyContents5");
$("<ol>").addClass("TOC5ul").appendTo(".TOC5");
bodyContents.each(function(index, element) {
    var paragraph = $(element);
    $("<li>").html("<a href=#"+paragraph.attr('id')+">"+ paragraph.html().replace(':','')+" </a> ").appendTo(".TOC5ul");
     });
//
var bodyContents = $(".bodyContents6");
$("<ol>").addClass("TOC6ul").appendTo(".TOC6");
bodyContents.each(function(index, element) {
    var paragraph = $(element);
    $("<li>").html("<a href=#"+paragraph.attr('id')+">"+ paragraph.html().replace(':','')+" </a> ").appendTo(".TOC6ul");
     });
//
var bodyContents = $(".bodyContents7");
$("<ol>").addClass("TOC7ul").appendTo(".TOC7");
bodyContents.each(function(index, element) {
    var paragraph = $(element);
    $("<li>").html("<a href=#"+paragraph.attr('id')+">"+ paragraph.html().replace(':','')+" </a> ").appendTo(".TOC7ul");
     });
//
var bodyContents = $(".bodyContents8");
$("<ol>").addClass("TOC8ul").appendTo(".TOC8");
bodyContents.each(function(index, element) {
    var paragraph = $(element);
    $("<li>").html("<a href=#"+paragraph.attr('id')+">"+ paragraph.html().replace(':','')+" </a> ").appendTo(".TOC8ul");
     });
//
var bodyContents = $(".bodyContents9");
$("<ol>").addClass("TOC9ul").appendTo(".TOC9");
bodyContents.each(function(index, element) {
    var paragraph = $(element);
    $("<li>").html("<a href=#"+paragraph.attr('id')+">"+ paragraph.html().replace(':','')+" </a> ").appendTo(".TOC9ul");
     });

</script>

<!-- VIDEO BUTTONS SCRIPT -->
<script type="text/javascript">
  function iframePopInject(event) {
    var $button = $(event.target);
    // console.log($button.parent().next());
    if ($button.attr('value') == 'show') {
        $button.attr('value', 'hide');
        $figure = $("<div>").addClass("video_container");
        $iframe = $("<iframe>").appendTo($figure);
        $iframe.attr("src", $button.attr("src"));
        // $iframe.attr("frameborder", "0");
        $iframe.attr("allowfullscreen", "true");
        $iframe.css("padding", "4px 6px");
        $button.next().css("display", "block");
        $figure.appendTo($button.next());
        $button.text("Hide Video")
    } else {
        $button.attr('value', 'show');
        $button.next().html("");
        $button.text("Show Video")
    }
}
</script>

<!-- BUTTON TRY -->
<script type="text/javascript">
  function iframePopA(event) {
    event.preventDefault();
    var $a = $(event.target).parent();
    console.log($a);
    if ($a.attr('value') == 'show') {
        $a.attr('value', 'hide');
        $figure = $("<div>");
        $iframe = $("<iframe>").addClass("popup_website_container").appendTo($figure);
        $iframe.attr("src", $a.attr("href"));
        $iframe.attr("frameborder", "1");
        $iframe.attr("allowfullscreen", "true");
        $iframe.css("padding", "4px 6px");
        $a.next().css("display", "block");
        $figure.appendTo($a.next().next());
        // $a.text("Hide Content")
        $('html, body').animate({
            scrollTop: $a.offset().top
        }, 1000);
    } else {
        $a.attr('value', 'show');
        $a.next().next().html("");
        // $a.text("Show Content")
    }

    $a.next().css("display", "inline");
}
</script>


<!-- TEXT BUTTON SCRIPT - INJECT -->
<script type="text/javascript">
  function showTextPopInject(event) {
    var $button = $(event.target);
    var txt = $button.attr("input");
    console.log(txt);
    if ($button.attr('value') == 'show') {
        $button.attr('value', 'hide');
        $p = $("<p>");
        $p.html(txt);
        $button.next().css("display", "block");
        $p.appendTo($button.next());
        $button.text("Hide Content")
    } else {
        $button.attr('value', 'show');
        $button.next().html("");
        $button.text("Show Content")
    }

}
</script>

<!-- TEXT BUTTON SCRIPT - HIDDEN / HIDE / SHOW / HIDE/SHOW -->
<script type="text/javascript">
  function showTextPopHide(event) {
    var $button = $(event.target);
    // var txt = $button.attr("input");
    var txt = $button.text();
    if ($button.attr('value') == 'show') {
        $button.attr('value', 'hide');
        $button.next().removeAttr("hidden");
        $button.text(txt + " - Hide Content");
    } else {
        $button.attr('value', 'show');
        $button.next().attr("hidden", "");
        $button.text(txt.replace(" - Hide Content",""));
    }
}
</script>

<!-- TEXT BUTTON SCRIPT - HIDDEN / HIDE / SHOW / HIDE/SHOW -->
<script type="text/javascript">
  function showText_withParent_PopHide(event) {
    var $button = $(event.target);
    var $parent = $button.parent();
    var txt = $button.text();
    if ($button.attr('value') == 'show') {
        $button.attr('value', 'hide');
        $parent.next().removeAttr("hidden");
        $button.text(txt + " - Hide Content");
    } else {
        $button.attr('value', 'show');
        $parent.next().attr("hidden", "");
        $button.text(txt.replace(" - Hide Content",""));
    }
}
</script>

<!-- Print / Printing / printme -->
<!-- <script type="text/javascript">
i = 0

for (var i = 1; i < 6; i++) {
    var bodyContents = $(".bodyContents" + i);
    $("<p>").addClass("TOC1ul")  .appendTo(".TOC1");
    bodyContents.each(function(index, element) {
        var paragraph = $(element);
        $("<li>").html("<a href=#"+paragraph.attr('id')+">"+ paragraph.html().replace(':','')+" </a> ").appendTo(".TOC1ul");
         });
} 
</script>
 -->
 
</html>

